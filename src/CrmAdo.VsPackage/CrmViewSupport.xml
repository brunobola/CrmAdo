<?xml version="1.0" encoding="utf-8"?>
<DataViewSupport xmlns="http://schemas.microsoft.com/VisualStudio/2007/07/Data/DataViewSupport">
  <!--<Define name="ColumnProperties">
    <Properties>
      <Property name="LogicalName">
        <DisplayName resource="Node_Column_AttributeLogicalName" />
        <Description resource="Node_Column_AttributeLogicalName_Description" />
      </Property>
    </Properties>
  </Define>-->

  <Views>
    <View name="Dynamics Crm">
      <DisplayName>CrmAdo Dynamics Crm</DisplayName>
      <ConnectionNode>
        <InitialDisplayName resource="Connection_DisplayName"></InitialDisplayName>
        <Commands>
          <!--
                        This command is a built-in command that can launch the Visual
                        Studio Query Designer to allow building a new query.  The command
                        provider is specified using a COM class ID registered in the
                        Visual Studio local registry hive.
                    -->
          <Command guid="501822E1-B5AF-11d0-B4DC-00A0C91506EF" cmdid="0x3528" provider="884DD964-5327-461f-9F06-6484DD540F8F" />
        </Commands>
        <Children>
          <StaticNode>
            <DisplayName resource="Node_Tables" />
            <Commands>
              <Command guid="501822E1-B5AF-11d0-B4DC-00A0C91506EF" cmdid="0x3528" provider="884DD964-5327-461f-9F06-6484DD540F8F" />
            </Commands>
            <Children>
              <!--
                                The children for this node are a selection of table objects.
                                This is specified using a Selection element with information
                                defining the appropriate call to be made to the data object
                                store.  For this sample, this means passing "Table" as the
                                type and null for each restriction except the type
                                restriction, which is "BASE TABLE".
                            -->
              <Selection type="Table">
                <!--
                                    A given selection also defines the characteristics for each
                                    object node that is returned as part of the selection.  In
                                    this case, the SelectionNode element defines how to present
                                    a table object.  Each table node is given a node ID which
                                    is used by table node children to request properties from
                                    the parent table node.
                                -->
                <SelectionNode nodeId="Table">
                  <!--
                                        Since the root object now provides default schema metadata
                                        we can add a condition to the display name of top level
                                        objects so it only shows the schema when it is a
                                        non-default schema.
                                    -->
                  <DisplayName resource="Node_Table" />
                  <!--
                                        Icons can be picked from a pre-existing set based on name
                                        or from a custom resource, or using an icon provider.
                                        This sample simply chooses "Table" from the existing set.
                                    -->
                  <Icon name="Table" />
                  <Commands>
                    <!--
                                            This command supplies an ability to launch the Visual
                                            Studio Query Designer prepopulated with the results of
                                            retrieving data from this table.  A requirement for this
                                            command to work is the ability to build a DSRef object
                                            from the underlying table object instance, as defined
                                            by including the IDSRefBuilder service for this type in
                                            the data object support XML file.
                                        -->
                    <Command guid="501822E1-B5AF-11d0-B4DC-00A0C91506EF" cmdid="0x3060" provider="884DD964-5327-461f-9F06-6484DD540F8F" />
                  </Commands>
                  <Children>
                    <!--
                                            Each table node contains the set of columns that are in
                                            that table.  This is defined with another selection
                                            with specific restrictions to ensure only columns for
                                            the appropriate table is returned.  The node ID defined
                                            on the parent table node is used to access properties
                                            of the table object using DDEX data specifiers.
                                        -->
                    <Selection type="Column" restrictions="{Table.LogicalName}">
                      <SelectionNode>
                        <Icon name="Column" />
                        <!--<PropertiesRef name="ColumnProperties" />-->
                      </SelectionNode>
                    </Selection>
                  </Children>
                </SelectionNode>
              </Selection>
            </Children>
          </StaticNode>



          <!--<StaticNode>
            <DisplayName>Tables</DisplayName>
            <Children>
              <Selection type="Table">
                <SelectionNode nodeId="Table">
                  <DisplayName>{LogicalName}</DisplayName>
                  <Icon name="Table" />
                  <Commands>
                    <Command guid="501822E1-B5AF-11d0-B4DC-00A0C91506EF" cmdid="0x3060" provider="884DD964-5327-461f-9F06-6484DD540F8F" />
                  </Commands>
                </SelectionNode>
              </Selection>
            </Children>
          </StaticNode>-->
        </Children>
      </ConnectionNode>
    </View>
  </Views>

  <Resources baseName="CrmAdo.DdexProvider.Resources">
    <Resource name="Connection_DisplayName">CrmAdo - {Root.Name}</Resource>
    <Resource name="Node_Tables">Tables</Resource>
    <Resource name="Node_Table">{LogicalName}</Resource>
    <Resource name="Node_Column_AttributeLogicalName">{LogicalName}</Resource>
    <Resource name="Node_Column_AttributeLogicalName_Description">The logical name of the attribute.</Resource>
  </Resources>

</DataViewSupport>